<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Aaron PESCASIO - Mémoire</title>
  <meta name="generator" content="VuePress 1.8.3">
  <link rel="apple-touch-icon" size="57x57" href="/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" size="60x60" href="/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" size="72x72" href="/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" size="76x76" href="/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" size="114x114" href="/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" size="120x120" href="/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" size="144x144" href="/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" size="152x152" href="/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" size="180x180" href="/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" size="192x192" href="/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" size="32x32" href="/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" size="96x96" href="/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" size="16x16" href="/icons/favicon-16x16.png">
  <link rel="manifest" href="/icons/manifest.json">
  <link rel="stylesheet" href="/memo/memo_files/style.css">
  <link rel="stylesheet" href="/memo/memo_files/lang.css">
  <link rel="shortcut icon" href="/memo/memo_files/logo.png" type="image/x-icon">
  <meta name="description" content="Aaron PESCASIO - Mémoire">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="4nm40QLVcDJmEJSAbrMfZ7fpBJZIXL1oSngBAYrZopY">

  <link rel="preload" href="/memo/memo_files/style.css" as="style">

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <meta name="description" content="Aaron Pescasio - Mémoire">
  <meta property="og:title" content="Aaron Pescasio">
  <meta property="og:description" content="Mémoire Administrateur">
  <meta property="og:image" content="https://www.apescasio.fr/memo/memo_files/logo.png">
  <meta property="og:url" content="https://www.apescasio.fr/memo">
</head>

<style>
  :root {
    --darkreader-neutral-background: #0e1011;
    --darkreader-neutral-text: #dcd8d3;
    --darkreader-selection-background: #004aac;
    --darkreader-selection-text: #edebe8;
  }

  a.sidebar-link {
    color: rgb(176, 197, 215);
  }


  * {
    scrollbar-color: #42474a #1b1e1f;
  }

  .navbar {
    background-color: rgb(19, 21, 22);
    border-bottom-color: rgb(49, 55, 57);
  }

  .sidebar {
    background-color: rgb(19, 21, 22);
    border-right-color: rgb(49, 55, 57);
  }

  .search-box input {
    color: rgb(137, 168, 193);
    border-color: rgb(57, 62, 64);
    outline-color: currentcolor;
    background-color: rgb(19, 21, 22);
    background-image: url("https://www.apescasio.fr/memo/memo_files/search-icon.svg");
  }


  .navbar .site-name {
    color: rgb(176, 197, 215);
  }

  pre {
    background-color: rgb(18, 19, 20);
    color: rgb(209, 204, 197);
    border-color: rgb(110, 102, 89);
  }

  a,
  p a code {
    color: #9066b8;
  }

  *,
  *:before,
  *:after {
    box-sizing: border-box;
  }

  body {
    color: rgb(176, 197, 215);
  }

  .search-result-text-color {
    background-color: #44484a;
    color: rgb(176, 197, 215);
  }

  @media screen and (max-width: 719px) {
    .logo {
      margin-top: -10px;
    }

    .page-navigation {
      flex-wrap: wrap;
    }

    .page-navigation {
      flex-wrap: wrap;
    }

    .prevpage,
    .nextpage {
      flex: 1;
      text-align: center;
      margin: 0;
    }

    .prevpage {
      order: 1;
    }

    .nextpage {
      order: 2;
    }
  }
</style>


<body>



  <!--navbar-->
  <div class="theme-container">
    <header class="navbar">
      <div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img"
          viewBox="0 0 448 512" class="icon">
          <path fill="currentColor"
            d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z">
          </path>
        </svg></div> <a href="https://apescasio.fr/" aria-current="page"
        class="home-link router-link-exact-active router-link-active"><img src="/memo/memo_files/logo.png" alt="AP"
          class="logo"></a> <a href="https://apescasio.fr/memo"><span class="site-name can-hide">Mémoire</span></a>
      <div class="links">
        <div class="search-box"><input type="text" id="search-input" aria-label="Search" autocomplete="off"
            spellcheck="false" value="">
          <ul id="search-results"></ul>
        </div>
        <nav class="nav-links can-hide">
          <div class="nav-item"><a href="/" aria-current="page"
              class="nav-link router-link-exact-active router-link-active chgcolor">
              Guide
            </a></div>
          <div class="nav-item"><a href="https://linkedin.com/in/aaron-pescasio" target="_blank"
              rel="noopener noreferrer" class="nav-link external">
              LinkedIn
              <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px"
                  viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
                  <path fill="currentColor"
                    d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z">
                  </path>
                  <polygon fill="currentColor"
                    points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9">
                  </polygon>
                </svg> <span class="sr-only">(opens new window)</span></span></a></div>
          <div class="nav-item"><a href="https://github.com/ApecioU/" target="_blank" rel="noopener noreferrer"
              class="nav-link external">
              GitHub
              <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px"
                  viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
                  <path fill="currentColor"
                    d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z">
                  </path>
                  <polygon fill="currentColor"
                    points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9">
                  </polygon>
                </svg> <span class="sr-only">(opens new window)</span></span></a></div>
          <!---->
        </nav>
      </div>
    </header>
    <div class="sidebar-mask"></div>
    <aside class="sidebar">
      <nav class="nav-links">
        <div class="nav-item"><a href="/" aria-current="page"
            class="nav-link router-link-exact-active router-link-active">
            Guide
          </a></div>
        <div class="nav-item"><a href="https://linkedin.com/in/aaron-pescasio" target="_blank" rel="noopener noreferrer"
            class="nav-link external">
            LinkedIn
            <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px"
                viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
                <path fill="currentColor"
                  d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z">
                </path>
                <polygon fill="currentColor"
                  points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9">
                </polygon>
              </svg> <span class="sr-only">(opens new window)</span></span></a></div>
        <div class="nav-item"><a href="https://github.com/apeciou" target="_blank" rel="noopener noreferrer"
            class="nav-link external">
            GitHub
            <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px"
                viewBox="0 0 100 100" width="15" height="15" class="icon outbound">
                <path fill="currentColor"
                  d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z">
                </path>
                <polygon fill="currentColor"
                  points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9">
                </polygon>
              </svg> <span class="sr-only">(opens new window)</span></span></a></div>
      </nav>
      <div class="carbon-ads"></div>
      <ul class="sidebar-links">
        <li>
          <div id="includedContent"></div>

        </li>
        <li>

        </li>

      </ul>
    </aside>
    <main class="page">
      <div class="theme-default-content content__default">
        <h1 id="what-is-fuse-js"><a href="#Aaron PESCASIO" class="header-anchor">#</a> Aaron PESCASIO</h1>
        <div><a href="https://twitter.com/apeciou" data-size="large" data-show-screen-name="false" data-dnt="true"
            data-show-count="false" class="twitter-follow-button">Follow</a>
          <script async="async" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        </div>
        <p>J'ai mit en place ce script pour afficher la dernière date de connexion d'un utilisateur ou de plusieurs utilisateurs. Ce script est à executér sur un serveur Windows contenant l'Active Directory.</p>

          <a class="pagesconst" onclick="copyAncienCode()">
            <h3>lastlogon.ps1:</h3>
          </a>
     
        <div class="code-container">
          <pre> 
            # Définition de la fonction pour obtenir 
            # la dernière date de connexion d'un utilisateur sélectionné
function Get-LastLogonDate {
    param([string]$samAccountName)

    # Obtient l'utilisateur correspondant au SamAccountName sélectionné
    $user = Get-ADUser -Filter "SamAccountName -eq '$samAccountName'" -Properties lastlogondate

    # Vérifie si la dernière date de connexion est disponible ou non
    if ($user.lastlogondate -ne $null) {
        $lastlogondate = $user.lastlogondate
        Write-Host "La dernière date de connexion pour $samAccountName est $lastlogondate"
    } else {
        Write-Host "La dernière date de connexion pour $samAccountName n'est pas disponible."
    }
}

# Loop to continue searching for users
do {
    # Demande à l'utilisateur de saisir un nom de famille
    $lastname = Read-Host -Prompt "Entrez le nom de famille"

    # Obtient les SamAccountName correspondant au nom de famille saisi
    $users = Get-ADUser -Filter "Surname -eq '$lastname'" -Properties lastlogondate | Select-Object SamAccountName, lastlogondate

    # Liste tous les SamAccountName trouvés
    Write-Host "Voici les noms de compte SAM trouvés :"
    $users | ForEach-Object { Write-Host $_.SamAccountName }

    # Demande à l'utilisateur de sélectionner SamAccountName
    $selecteduser = Read-Host -Prompt "Entrez le nom de compte SAM de l'utilisateur dont vous souhaitez vérifier la dernière date de connexion"

    # Get the last logon date for the selected user
    Get-LastLogonDate -samAccountName $selecteduser

    # Demande à l'utilisateur s'il veut continuer la recherche
    $continue = Read-Host -Prompt "Voulez-vous continuer la recherche de l'utilisateur ? (Entrez 'N' pour arrêter, appuyez sur Entrée pour continuer)"

} while ($continue -notmatch "[Nn]")

            
            
          </pre>

          <button class="copy-button">Copy</button>
        </div>
        <!-- <a class="pagesconst" onclick="copyNouveauCode()">
          <h3>lastlogonv2.ps1:</h3>
        </a>


        <div class="code-container">
          <pre> 
            # Script (à executer sur le nouveau PC) pour importer les:
            # signatures Outlook, les imprimantes, les favoris Chrome/Edge... 
            # sur le disque de nouveau PC!

            $username23 = "$env:USERDOMAIN\$env:USERNAME"
            $date23 = Get-Date -Format "dd/MM/yyyy à HH:mm:ss"
            $log23 = "$username23 a executé le script: import_nouveauPC.bat le $date23"
            Add-Content -Path "\\adds01\LOGI\ap_script\ap_script_logs\import_nouveauPC.log" -Value $log23
            
            # Import Favoris => Chrome
            
            Copy-Item "\\adds01\personnel\$env:USERNAME\MIGRATIONP5_$env:USERNAME\Bookmarks_ch" "$env:localappdata\Google\Chrome\User Data\Default\Bookmarks" -Force
            
            #Import Favoris => Edge
            
            Copy-Item "\\adds01\personnel\$env:USERNAME\MIGRATIONP5_$env:USERNAME\Bookmarks_ms" "$env:localappdata\Microsoft\Edge\User Data\Default\Bookmarks" -Force
            
            #Import Signatures Outlook
            
            if (!(Test-Path -Path "$env:appdata\Microsoft\Signatures" -PathType Container)) {
              New-Item -Type Directory "$env:appdata\Microsoft\Signatures"
                Copy-Item "\\adds01\personnel\$env:USERNAME\MIGRATIONP5_$env:USERNAME\Signatures\*" "$env:appdata\Microsoft\Signatures" -Force
            
            } else {
                Copy-Item "\\adds01\personnel\$env:USERNAME\MIGRATIONP5_$env:USERNAME\Signatures\*" "$env:appdata\Microsoft\Signatures" -Force
            }
            
            #Import imprimantes sur le nouveau PC
            
            $Printers = Import-Csv -Path "\\adds01\personnel\$env:USERNAME\MIGRATIONP5_$env:USERNAME\ecoleprinters.csv"
            foreach ($Printer in $Printers)
            {
                $PrinterName = $Printer.Name
                if (Get-Printer -Name $PrinterName 2>$null)
                {
                    Write-Host "L'imprimante $PrinterName est deja installe!"
                } else {
                    Add-Printer -ConnectionName $PrinterName
            
                }
            }
          </pre>

          <button class="copy-button">Copy</button>
        </div> -->



        <div class="page-navigation">
          <a href="https://apescasio.fr/memo/vt/ad" class="prevpage"><strong>
              << Virtualisation</strong></a>
          <a href="https://apescasio.fr/memo/ws/integration" class="nextpage"><strong>WS-Integration >></strong></a>
        </div>



      </div>
    </main>
    <script>
      function copyAncienCode() {
        var code = document.querySelectorAll('.code-container')[0].querySelector('pre').textContent;
        navigator.clipboard.writeText(code);
      }
    
      function copyNouveauCode() {
        var code = document.querySelectorAll('.code-container')[1].querySelector('pre').textContent;
        navigator.clipboard.writeText(code);
      }
    </script>
    <script src="/memo/memo_files/precode.js"></script>
    <script src="/memo/memo_files/script.js"></script>
    <script src="/memo/memo_files/nav.js"></script>
    <script src="/pff/include.js"></script>
    <script>
      $(function () {
        $("#includedContent").load("/memo/memo_files/headermemo.txt");
      });
    </script>
</body>

</html>